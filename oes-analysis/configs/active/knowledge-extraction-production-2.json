{
  "transcripts_directory": "topic-taxonomies/monash-tp1-categorised-1-to-3-equal-duration-subset-100-fixed",
  "output_directory": "knowledge-extraction-production-2",
  "_comment": "Multi-node architecture: Each node extracts one category of facts with full 8K token budget. Consolidation script merges outputs.",
  "nodes": [
    {
      "name": "policy_extraction",
      "inputs": [
        "transcript"
      ],
      "models": [
        {
          "provider": "gemini",
          "model": "gemini-2.5-flash",
          "mini": false,
          "max_tokens": 20000
        }
      ],
      "response_format": {
        "type": "json_schema",
        "json_schema": {
          "name": "PolicyExtractionResponse",
          "strict": true,
          "schema": {
            "type": "object",
            "properties": {
              "topic_id": {
                "type": "string",
                "description": "The unique identifier for this topic"
              },
              "topic_name": {
                "type": "string",
                "description": "Name of the topic"
              },
              "policies": {
                "type": "array",
                "description": "Institutional policies, rules, and regulations mentioned across all segments",
                "items": {
                  "type": "object",
                  "properties": {
                    "policy": {
                      "type": "string",
                      "description": "Clear statement of the policy"
                    },
                    "details": {
                      "type": "string",
                      "description": "Additional context, clarifications, or implications"
                    },
                    "exceptions": {
                      "type": "array",
                      "description": "Exceptions or special circumstances for this policy",
                      "items": {
                        "type": "string"
                      }
                    },
                    "references": {
                      "type": "array",
                      "description": "Which call segments mention this policy, with actual statements from those segments",
                      "items": {
                        "type": "object",
                        "properties": {
                          "call_id": {
                            "type": "string",
                            "description": "The call ID where this was mentioned"
                          },
                          "start_segment_id": {
                            "type": "integer",
                            "description": "Starting segment number"
                          },
                          "end_segment_id": {
                            "type": "integer",
                            "description": "Ending segment number"
                          },
                          "excerpt": {
                            "type": "string",
                            "description": "The actual consultant or student dialogue from these segments. Include 1-3 key turns of conversation showing how this policy was mentioned, with speaker labels (Consultant:/Student:)."
                          }
                        },
                        "required": [
                          "call_id",
                          "start_segment_id",
                          "end_segment_id",
                          "excerpt"
                        ],
                        "additionalProperties": false
                      }
                    }
                  },
                  "required": [
                    "policy",
                    "references"
                  ],
                  "additionalProperties": false
                }
              }
            },
            "required": [
              "topic_id",
              "topic_name",
              "policies"
            ],
            "additionalProperties": false
          }
        }
      }
    },
    {
      "name": "requirement_extraction",
      "inputs": [
        "transcript"
      ],
      "models": [
        {
          "provider": "gemini",
          "model": "gemini-2.5-flash",
          "mini": false,
          "max_tokens": 20000
        }
      ],
      "response_format": {
        "type": "json_schema",
        "json_schema": {
          "name": "RequirementExtractionResponse",
          "strict": true,
          "schema": {
            "type": "object",
            "properties": {
              "topic_id": {
                "type": "string",
                "description": "The unique identifier for this topic"
              },
              "topic_name": {
                "type": "string",
                "description": "Name of the topic"
              },
              "requirements": {
                "type": "array",
                "description": "Entry requirements, qualifications, prerequisites, eligibility criteria",
                "items": {
                  "type": "object",
                  "properties": {
                    "requirement": {
                      "type": "string",
                      "description": "Clear statement of the requirement"
                    },
                    "variations": {
                      "type": "array",
                      "description": "Different acceptable ways to meet this requirement",
                      "items": {
                        "type": "string"
                      }
                    },
                    "exceptions": {
                      "type": "array",
                      "description": "Exceptions or special cases",
                      "items": {
                        "type": "string"
                      }
                    },
                    "references": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "call_id": {
                            "type": "string"
                          },
                          "start_segment_id": {
                            "type": "integer"
                          },
                          "end_segment_id": {
                            "type": "integer"
                          },
                          "excerpt": {
                            "type": "string",
                            "description": "Actual dialogue excerpt mentioning this requirement with speaker labels (Consultant:/Student:)."
                          }
                        },
                        "required": [
                          "call_id",
                          "start_segment_id",
                          "end_segment_id",
                          "excerpt"
                        ],
                        "additionalProperties": false
                      }
                    }
                  },
                  "required": [
                    "requirement",
                    "references"
                  ],
                  "additionalProperties": false
                }
              }
            },
            "required": [
              "topic_id",
              "topic_name",
              "requirements"
            ],
            "additionalProperties": false
          }
        }
      }
    },
    {
      "name": "timeline_extraction",
      "inputs": [
        "transcript"
      ],
      "models": [
        {
          "provider": "gemini",
          "model": "gemini-2.5-flash",
          "mini": false,
          "max_tokens": 20000
        }
      ],
      "response_format": {
        "type": "json_schema",
        "json_schema": {
          "name": "TimelineExtractionResponse",
          "strict": true,
          "schema": {
            "type": "object",
            "properties": {
              "topic_id": {
                "type": "string",
                "description": "The unique identifier for this topic"
              },
              "topic_name": {
                "type": "string",
                "description": "Name of the topic"
              },
              "timelines": {
                "type": "array",
                "description": "Durations, deadlines, schedules, timeframes mentioned",
                "items": {
                  "type": "object",
                  "properties": {
                    "timeline": {
                      "type": "string",
                      "description": "Complete timeline statement combining what event/process is involved, how long it takes, and relevant context. Format: '[Event/Process]: [Duration/Timeframe]. [Additional context if applicable].' Example: 'Application processing: Takes 2-3 weeks from submission. Students should plan accordingly and check email regularly for updates.'"
                    },
                    "references": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "call_id": {
                            "type": "string"
                          },
                          "start_segment_id": {
                            "type": "integer"
                          },
                          "end_segment_id": {
                            "type": "integer"
                          },
                          "excerpt": {
                            "type": "string",
                            "description": "Actual dialogue excerpt mentioning this timeline with speaker labels (Consultant:/Student:)."
                          }
                        },
                        "required": [
                          "call_id",
                          "start_segment_id",
                          "end_segment_id",
                          "excerpt"
                        ],
                        "additionalProperties": false
                      }
                    }
                  },
                  "required": [
                    "timeline",
                    "references"
                  ],
                  "additionalProperties": false
                }
              }
            },
            "required": [
              "topic_id",
              "topic_name",
              "timelines"
            ],
            "additionalProperties": false
          }
        }
      }
    },
    {
      "name": "edge_case_extraction",
      "inputs": [
        "transcript"
      ],
      "models": [
        {
          "provider": "gemini",
          "model": "gemini-2.5-flash",
          "mini": false,
          "max_tokens": 20000
        }
      ],
      "response_format": {
        "type": "json_schema",
        "json_schema": {
          "name": "EdgeCaseExtractionResponse",
          "strict": true,
          "schema": {
            "type": "object",
            "properties": {
              "topic_id": {
                "type": "string",
                "description": "The unique identifier for this topic"
              },
              "topic_name": {
                "type": "string",
                "description": "Name of the topic"
              },
              "edge_cases": {
                "type": "array",
                "description": "Special circumstances, exceptions, unusual situations discussed",
                "items": {
                  "type": "object",
                  "properties": {
                    "case": {
                      "type": "string",
                      "description": "Description of the edge case or special circumstance"
                    },
                    "handling": {
                      "type": "string",
                      "description": "How this case is handled or resolved"
                    },
                    "references": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "call_id": {
                            "type": "string"
                          },
                          "start_segment_id": {
                            "type": "integer"
                          },
                          "end_segment_id": {
                            "type": "integer"
                          },
                          "excerpt": {
                            "type": "string",
                            "description": "Actual dialogue excerpt showing this edge case with speaker labels (Consultant:/Student:)."
                          }
                        },
                        "required": [
                          "call_id",
                          "start_segment_id",
                          "end_segment_id",
                          "excerpt"
                        ],
                        "additionalProperties": false
                      }
                    }
                  },
                  "required": [
                    "case",
                    "handling",
                    "references"
                  ],
                  "additionalProperties": false
                }
              }
            },
            "required": [
              "topic_id",
              "topic_name",
              "edge_cases"
            ],
            "additionalProperties": false
          }
        }
      }
    },
    {
      "name": "other_extraction",
      "inputs": [
        "transcript"
      ],
      "models": [
        {
          "provider": "gemini",
          "model": "gemini-2.5-flash",
          "mini": false,
          "max_tokens": 20000
        }
      ],
      "response_format": {
        "type": "json_schema",
        "json_schema": {
          "name": "OtherExtractionResponse",
          "strict": true,
          "schema": {
            "type": "object",
            "properties": {
              "topic_id": {
                "type": "string",
                "description": "The unique identifier for this topic"
              },
              "topic_name": {
                "type": "string",
                "description": "Name of the topic"
              },
              "others": {
                "type": "array",
                "description": "Important information that doesn't fit in other categories",
                "items": {
                  "type": "object",
                  "properties": {
                    "category": {
                      "type": "string",
                      "description": "What type of information this is (e.g., 'contact information', 'resource availability', 'system details')"
                    },
                    "content": {
                      "type": "string",
                      "description": "Complete information statement combining the actual content and why it matters for consultants. Format: '[The information]. [Why it's relevant/important for consultants].' Example: 'Students need their student ID ready during calls. This is required for system lookup and to proceed with enrollment verification without delays.'"
                    },
                    "references": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "call_id": {
                            "type": "string"
                          },
                          "start_segment_id": {
                            "type": "integer"
                          },
                          "end_segment_id": {
                            "type": "integer"
                          },
                          "excerpt": {
                            "type": "string",
                            "description": "Actual dialogue excerpt showing this information with speaker labels (Consultant:/Student:)."
                          }
                        },
                        "required": [
                          "call_id",
                          "start_segment_id",
                          "end_segment_id",
                          "excerpt"
                        ],
                        "additionalProperties": false
                      }
                    }
                  },
                  "required": [
                    "category",
                    "content",
                    "references"
                  ],
                  "additionalProperties": false
                }
              }
            },
            "required": [
              "topic_id",
              "topic_name",
              "others"
            ],
            "additionalProperties": false
          }
        }
      }
    }
  ]
}