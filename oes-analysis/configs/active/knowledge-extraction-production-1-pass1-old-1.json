{
  "transcripts_directory": "topic-taxonomies/monash-tp1-categorised-1-to-3-equal-duration-subset-100-fixed",
  "output_directory": "knowledge-extraction-production-1-pass1__monash-tp1-categorised-1-to-3-equal-duration-subset-100-fixed",

  "_comment": "Input explanation: 'transcript' refers to the topic taxonomy JSON files in transcripts_directory. Each file contains aggregated segments from multiple calls about one topic. The system automatically loads the file content and substitutes it into the {transcript} placeholder in the prompt.",

  "nodes": [
    {
      "name": "fact_extraction",
      "inputs": [
        "transcript"
      ],
      "models": [
        {
          "provider": "gemini",
          "model": "gemini-2.5-flash",
          "mini": false
        }
      ],
      "response_format": {
        "type": "json_schema",
        "json_schema": {
          "name": "TopicFactExtractionResponse",
          "strict": true,
          "schema": {
            "type": "object",
            "properties": {
              "topic_id": {
                "type": "string",
                "description": "The unique identifier for this topic"
              },
              "topic_name": {
                "type": "string",
                "description": "Name of the topic"
              },
              "knowledge_facts": {
                "type": "object",
                "description": "Structured knowledge extracted from all segments in this topic",
                "properties": {
                  "policies": {
                    "type": "array",
                    "description": "Institutional policies, rules, and regulations mentioned across all segments",
                    "items": {
                      "type": "object",
                      "properties": {
                        "policy": {
                          "type": "string",
                          "description": "Clear statement of the policy"
                        },
                        "details": {
                          "type": "string",
                          "description": "Additional context, clarifications, or implications"
                        },
                        "segment_references": {
                          "type": "array",
                          "description": "Which call segments mention this policy",
                          "items": {
                            "type": "object",
                            "properties": {
                              "call_id": {
                                "type": "string"
                              },
                              "segment_ids": {
                                "type": "array",
                                "items": {
                                  "type": "integer"
                                }
                              }
                            },
                            "required": ["call_id", "segment_ids"],
                            "additionalProperties": false
                          }
                        },
                        "exceptions": {
                          "type": "array",
                          "description": "Exceptions or special circumstances for this policy",
                          "items": {
                            "type": "string"
                          }
                        }
                      },
                      "required": ["policy", "segment_references"],
                      "additionalProperties": false
                    }
                  },
                  "requirements": {
                    "type": "array",
                    "description": "Entry requirements, qualifications, prerequisites, eligibility criteria",
                    "items": {
                      "type": "object",
                      "properties": {
                        "requirement": {
                          "type": "string",
                          "description": "Clear statement of the requirement"
                        },
                        "variations": {
                          "type": "array",
                          "description": "Different acceptable ways to meet this requirement",
                          "items": {
                            "type": "string"
                          }
                        },
                        "exceptions": {
                          "type": "array",
                          "description": "Exceptions or special cases",
                          "items": {
                            "type": "string"
                          }
                        },
                        "segment_references": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "call_id": {
                                "type": "string"
                              },
                              "segment_ids": {
                                "type": "array",
                                "items": {
                                  "type": "integer"
                                }
                              }
                            },
                            "required": ["call_id", "segment_ids"],
                            "additionalProperties": false
                          }
                        }
                      },
                      "required": ["requirement", "segment_references"],
                      "additionalProperties": false
                    }
                  },
                  "timelines": {
                    "type": "array",
                    "description": "Durations, deadlines, schedules, timeframes mentioned",
                    "items": {
                      "type": "object",
                      "properties": {
                        "event": {
                          "type": "string",
                          "description": "What this timeline refers to"
                        },
                        "duration": {
                          "type": "string",
                          "description": "The time period, deadline, or schedule"
                        },
                        "details": {
                          "type": "string",
                          "description": "Additional context about this timeline"
                        },
                        "segment_references": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "call_id": {
                                "type": "string"
                              },
                              "segment_ids": {
                                "type": "array",
                                "items": {
                                  "type": "integer"
                                }
                              }
                            },
                            "required": ["call_id", "segment_ids"],
                            "additionalProperties": false
                          }
                        }
                      },
                      "required": ["event", "duration", "segment_references"],
                      "additionalProperties": false
                    }
                  },
                  "edge_cases": {
                    "type": "array",
                    "description": "Special circumstances, exceptions, unusual situations discussed",
                    "items": {
                      "type": "object",
                      "properties": {
                        "case": {
                          "type": "string",
                          "description": "Description of the edge case or special circumstance"
                        },
                        "handling": {
                          "type": "string",
                          "description": "How this case is handled or resolved"
                        },
                        "segment_references": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "call_id": {
                                "type": "string"
                              },
                              "segment_ids": {
                                "type": "array",
                                "items": {
                                  "type": "integer"
                                }
                              }
                            },
                            "required": ["call_id", "segment_ids"],
                            "additionalProperties": false
                          }
                        }
                      },
                      "required": ["case", "handling", "segment_references"],
                      "additionalProperties": false
                    }
                  },
                  "others": {
                    "type": "array",
                    "description": "Important information that doesn't fit in other categories",
                    "items": {
                      "type": "object",
                      "properties": {
                        "category": {
                          "type": "string",
                          "description": "What type of information this is (e.g., 'contact information', 'resource availability', 'system details')"
                        },
                        "content": {
                          "type": "string",
                          "description": "The actual information"
                        },
                        "relevance": {
                          "type": "string",
                          "description": "Why this information is important for consultants to know"
                        },
                        "segment_references": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "call_id": {
                                "type": "string"
                              },
                              "segment_ids": {
                                "type": "array",
                                "items": {
                                  "type": "integer"
                                }
                              }
                            },
                            "required": ["call_id", "segment_ids"],
                            "additionalProperties": false
                          }
                        }
                      },
                      "required": ["category", "content", "segment_references"],
                      "additionalProperties": false
                    }
                  }
                },
                "required": ["policies", "requirements", "timelines", "edge_cases", "others"],
                "additionalProperties": false
              }
            },
            "required": ["topic_id", "topic_name", "knowledge_facts"],
            "additionalProperties": false
          }
        }
      }
    }
  ]
}
